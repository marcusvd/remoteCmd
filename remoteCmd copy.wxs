<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="remoteCmd Service" Language="1033" Version="1.0.0.0"
           Manufacturer="NoStopTI" UpgradeCode="12345678-ABCD-1234-ABCD-1234567890AB"
           Codepage="65001">
    <Package InstallerVersion="500" Compressed="yes" InstallScope="perMachine" />

    <MediaTemplate />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="remoteCmd" />
      </Directory>
    </Directory>

    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Id="ServiceComponent" Guid="C6A3A2C4-6DF3-4B8A-85A5-F1A5E7A1D1A7">
        <File Id="remoteCmdExe" Name="remoteCmd.exe" Source="remoteCmd.exe" KeyPath="yes" />

        <ServiceInstall Id="InstallRemoteCmd"
                        Name="remoteCmd"
                        DisplayName="remoteCmd Service"
                        Description="Servico para execucao remota de comandos"
                        Start="auto"
                        Type="ownProcess"
                        ErrorControl="normal" />
        
        <!-- Não iniciar o serviço durante a instalação -->
        <ServiceControl Id="StartRemoteCmd"
                        Name="remoteCmd"
                        Stop="both"
                        Remove="uninstall"
                        Wait="yes" />
      </Component>
    </ComponentGroup>

    <Feature Id="MainFeature" Title="remoteCmd Service" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>

  </Product>
</Wix>
